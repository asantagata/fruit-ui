const e="page";function t(){const t=new URLSearchParams(window.location.search);return t.get(e)??""}function n(e,t){if(e[t])return e[t];if(e[`/${t}`])return e[`/${t}`];if(e["*"])return e["*"];if(e["/*"])return e["/*"];return{}}function o(e,t){if(t.to){e.scrollTo({...t,top:t.to.y,left:t.to.x})}else{e.scrollIntoView(t)}}function i(e,t){if(window.location.hash&&document.getElementById(window.location.hash.slice(1))){if(t.hashed)o(document.getElementById(window.location.hash.slice(1)),t.hashed)}else{if(t.unhashed)o(e,t.unhashed)}}function r(e,o={hashed:{},unhashed:{to:{x:0,y:0}}},r={}){return{state(){const o=t();const i=n(e,o);return{element:(()=>{if(Object.getPrototypeOf(i.route).constructor.name==="AsyncFunction"){i.route(o).then(e=>{document.getElementById("router").dispatchEvent(new CustomEvent("initrouterload",{detail:{element:e}}))});return r}else{return i.route(o)}})()}},render(){return{children:typeof this.state.element==="object"?{...this.state.element,key:`route-${t()}`}:this.state.element,id:"router",dataset:{receivePageChanges:true,receiveHashChanges:true},on:{pagechange(){const r=t();const s=n(e,r);if(Object.getPrototypeOf(s.route).constructor.name==="AsyncFunction"){s.route(r).then(e=>{this.state.element=e;this.rerender();i(this.element,o)})}else{this.state.element=s.route(r);this.rerender();i(this.element,o)}document.title=n(e,t()).title??document.title},hashchange(){i(this.element,o)},mount(){document.title=n(e,t()).title??document.title;window.onpopstate=()=>c(t());const r=t();const s=n(e,r);if(Object.getPrototypeOf(s.route).constructor.name!=="AsyncFunction")i(this.element,o)},initrouterload(e){this.state.element=e.detail.element;this.rerender();i(this.element,o)}}}},memo(){return t()}}}function s(n){if(n.startsWith("/"))n=n.slice(1);let o="";if(n.includes("#")){o=n.slice(n.indexOf("#"));n=n.slice(0,n.indexOf("#"))}if(n===t())return;const i=new URL(window.location.href);i.searchParams.set(e,n);i.hash=o;window.history.pushState({},"",i);c(n)}function c(e){const t=new CustomEvent("pagechange",{detail:{page:e}});Array.from(document.querySelectorAll(`[data-receive-page-changes]`)).forEach(e=>{e.dispatchEvent(t)})}function a(e){e=e.slice(e.indexOf("#")+1);const t=new URL(window.location.href);t.hash=e;if(e!==h())window.history.pushState({},"",t);u(e)}function h(){return window.location.hash.slice(1)}function u(e){const t=new CustomEvent("hashchange",{detail:{hash:e}});Array.from(document.querySelectorAll(`[data-receive-hash-changes]`)).forEach(e=>{e.dispatchEvent(t)})}export{s as navigate,r as Router,t as getPage,a as navigateHash,h as getHash};