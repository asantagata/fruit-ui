<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" href="data:,">
    <title>Hi</title>
    <style>
        @keyframes fade {
            0% {opacity: 0}
            100% {opacity: 1}
        }

        #parent {
            display: flex;
            gap: 20px;
            flex-direction: column;
        }

        #parent > div {
            animation: fade 0.5s ease;
            display: flex;
            gap: 5px;
            flex-shrink: 0;
        }

        #parent > div > * {
            width: 150px;
        }
    </style>
</head>
<body style="background: #ccc">
</body>
<script type="module">
    import * as fruit from '../src/index.js';

    // [text, text] to [text, element, text]
    fruit.appendChild(document.body, {
        state() { return { children: ['hello', 'world'] } },
        render() {
            return {
                children: this.state.children,
                on: {click() {this.setState.children(['helloo', {children: 'DIV'}, 'worldd'])}}
            }
        }
    });

    // [element] to [text]
    fruit.appendChild(document.body, {
        state() { return { children: {children: 'DIV'} } },
        render() {
            return {
                children: this.state.children,
                on: {click() {this.setState.children('helloo')}}
            }
        }
    });

    // [text] to [element]
    fruit.appendChild(document.body, {
        state() { return { children: 'helloo' } },
        render() {
            return {
                children: this.state.children,
                on: {click() {this.setState.children({children: 'DIV'})}}
            }
        }
    });

    fruit.appendChild(document.body, {
        state() {return {i: true}},
        render() {
            return {
                children: [
                    {tag: 'button', children: 'toggle', on: {click() {this.setState.i(!this.state.i)}}},
                    ...(this.state.i ? [{children: 'hello'}] : [])
                ]
            }
        }
    })

    // fruit.appendChild(document.body, {
    //     state: {i: false},
    //     render() {
    //         return {
    //             tag: 'input',
    //             type: 'checkbox',
    //             checked: this.state.i || undefined,
    //             autocomplete: 'off',
    //             on: {
    //                 mount() {
    //                     window.setInterval(() => {
    //                         this.setState.i(!this.state.i);
    //                     }, 500)
    //                 }
    //             }
    //         };
    //     }
    // });

    fruit.appendChild(document.body, {
        state() {
            window.setInterval(() => {
                console.log(this.bindings['switching-monkey']);
            }, 12538)
        },
        render() {
            return {
                tag: 'div',
                children: {
                    children: [{}, {}, {
                        children: ['hi', {
                            binding: 'switching-monkey',
                            state() {
                                window.setInterval(() => {
                                    this.setState.i(!this.state.i);
                                }, 500)
                                return { i: false };
                            },
                            render() {
                                return {
                                    tag: this.state.i ? 'b' : 'u',
                                    children: 'test'
                                };
                            }
                        }, {}, {}]
                    }]
                }
            }
        }
    });

    fruit.appendChild(document.body, {HTML: '<a href="whatssup">hi</a>', tag: 'div', children: 'Ahhh'});
</script>
</html>
